---
layout: post
title: เพราะเวลาของสองเราไม่เท่ากัน (mysql, js epoch time are not equals)
---

เรื่องมันมีอยู่ว่า ผมเก็บข้อมูล timestamp ไว้ใน mysql แล้วต้องการนำมาแสดงผลเฉพาะเวลาบน angularjs ซึ่งแน่นอนว่าทุกอย่างควรจะจบอย่างง่ายดายด้วยการใช้ date filter ว่า

```html
{{ created_at | date : 'HH:mm' }}
```

แต่พอใช้จริงแล้วปรากฏว่าเวลาที่ได้มันมั่วสิ้นดี เอาล่ะงั้นใจเย็นๆ แล้วลอง debug ดูเริ่มจากการดูค่า epoch time ที่ได้จาก mysql

```
mysql> select unix_timestamp(current_timestamp);
+-----------------------------------+
| unix_timestamp(current_timestamp) |
+-----------------------------------+
|                        1461632162 |
+-----------------------------------+
```

แล้วมาดู epoch time ของ javascript กันบ้าง

```
> new Date().valueOf()
1461632189808
```

อ้าว ค่ามันไม่เหมือนกันนิ เหมือนว่าของ js จะมากกว่าอยู่ 1000 เท่า แล้วหลังจากได้สงบสติอารมณ์แล้วผมก็สังเกตได้ว่า

* mysql มี epoch time เป็นหน่วย second
* js มีหน่วย epoch time เป็น millisecond

## วิธีการแก้ไข
    
ถ้ารู้มันห่างกันเท่าไหร่ก็จับทำให้มันเท่ากันเสียสิ แน่นอนก็ให้คูณ 1000 เข้าไปตอนแสดงผลก็เรียบร้อยแล้ว

```html
{{ created_at * 1000 | date : 'HH:mm' }}
```
```
